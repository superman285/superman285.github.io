<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Promiseæ‰‹æœ­"><meta name="keywords" content="JavaScript,Promise"><meta name="author" content="superman285"><meta name="copyright" content="superman285"><title>Promiseæ‰‹æœ­ | Superman285ã®Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f95f9792a34045b9d58c63113e1af8d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#åŒæ­¥å¼‚æ­¥"><span class="toc-number">1.</span> <span class="toc-text">åŒæ­¥å¼‚æ­¥</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å…ˆè®°ä½å†™æ³•"><span class="toc-number">2.</span> <span class="toc-text">å…ˆè®°ä½å†™æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#PromiseçŠ¶æ€"><span class="toc-number">3.</span> <span class="toc-text">PromiseçŠ¶æ€</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Promiseå¯¹è±¡çš„thenæ–¹æ³•"><span class="toc-number">4.</span> <span class="toc-text">Promiseå¯¹è±¡çš„thenæ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#catch"><span class="toc-number">4.1.</span> <span class="toc-text">catch</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#finally"><span class="toc-number">4.2.</span> <span class="toc-text">finally</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Promiseå¤šä»»åŠ¡å¤„ç†"><span class="toc-number">5.</span> <span class="toc-text">Promiseå¤šä»»åŠ¡å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹-jså†…ç½®å±æ€§-prop-åŒæ–¹æ‹¬å·"><span class="toc-number">5.1.</span> <span class="toc-text">ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹:jså†…ç½®å±æ€§[[prop]] åŒæ–¹æ‹¬å·</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#asyncå’Œawait-å¾ˆç”œçš„è¯­æ³•ç³–"><span class="toc-number">6.</span> <span class="toc-text">asyncå’Œawait å¾ˆç”œçš„è¯­æ³•ç³–</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.loli.net/2019/02/21/5c6e32e5dbb4a.jpg"></div><div class="author-info__name text-center">superman285</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/superman285">Git Me Follow</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">46</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">44</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">22</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">FriendLinks</div><a class="author-info-links__name text-center" href="http://154.8.215.126:4001">ETH-Notes</a><a class="author-info-links__name text-center" href="https://molunerfinn.com/hexo-theme-melody-doc/zh-Hans">Beauty Hexo-Theme</a><a class="author-info-links__name text-center" href="https://minimalwang.xyz">ä¸€ä¸ªæ¸…æ–°è„±ä¿—çš„å‰ç«¯</a></div></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="80" src="//music.163.com/outchain/player?type=2&amp;id=583503&amp;auto=1&amp;height=66" style="margin-top: 2rem;"></iframe><div class="unit"><div class="heart"><div class="heart-piece-0"></div><div class="heart-piece-1"></div><div class="heart-piece-2"></div><div class="heart-piece-3"></div><div class="heart-piece-4"></div><div class="heart-piece-5"></div><div class="heart-piece-6"></div><div class="heart-piece-7"></div><div class="heart-piece-8"></div></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/02/22/5c6f8ab4867b6.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Superman285ã®Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">é¦–é¡µ</a><a class="site-page" href="/archives">æ—¶å…‰æœº</a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a><a class="site-page" href="/categories/BlockChain">åŒºå—é“¾</a><a class="site-page" href="/categories/Entertain">å¨±ä¹</a><a class="site-page" href="/Works">ä½œå“é›†</a></span></div><div id="post-info"><div id="post-title">Promiseæ‰‹æœ­</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-02</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/FrontEnd/">FrontEnd</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/FrontEnd/JavaScript/">JavaScript</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/FrontEnd/JavaScript/Promise/">Promise</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h5 id="åŒæ­¥å¼‚æ­¥"><a href="#åŒæ­¥å¼‚æ­¥" class="headerlink" title="åŒæ­¥å¼‚æ­¥"></a>åŒæ­¥å¼‚æ­¥</h5><p>scriptæ ‡ç­¾åŠ è½½æ–¹å¼ä¸ºåŒæ­¥é˜»å¡æ–¹å¼ï¼Œæ‰€ä»¥ä¸€èˆ¬æ”¾åœ¨bodyæœ€å</p>
<p>æœ€æ–°esç‰ˆæœ¬ scriptæ ‡ç­¾å¢åŠ äº†asyncå±æ€§ å¯è®¾ç½®ä¸ºtrue åˆ™ä¸ºå¼‚æ­¥åŠ è½½</p>
<p>createElementåˆ›å»ºscriptå¯¹è±¡åŠ è½½ ä¸ºå¼‚æ­¥éé˜»å¡æ¨¡å¼</p>
<h5 id="å…ˆè®°ä½å†™æ³•"><a href="#å…ˆè®°ä½å†™æ³•" class="headerlink" title="å…ˆè®°ä½å†™æ³•"></a>å…ˆè®°ä½å†™æ³•</h5><p>new Promise(function(resolve,reject){dosomething(å¼‚æ­¥ä»£ç )})</p>
<p>==ç­‰ä»·äº==</p>
<p>new Promise((resolve,reject)=&gt;{dosomething(å¼‚æ­¥ä»£ç )})</p>
<p>Promiseä¸ºjså†…ç½®çš„æ„é€ å‡½æ•°ï¼Œæ„é€ çš„Promiseå¯¹è±¡æ˜¯==ä¸“é—¨ç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡çš„ç®¡ç†å·¥å…·==</p>
<blockquote>
<p>Promiseå¹¶ä¸æ˜¯å°†å¼‚æ­¥å˜ä¸ºåŒæ­¥</p>
<p>è€Œæ˜¯æä¾›äº†ä¸€ç§å¼‚æ­¥ä»£ç çš„ç®¡ç†æ–¹å¼ï¼Œå°†åµŒå¥—å…³ç³»(å›è°ƒåœ°ç‹±)å˜ä¸ºå¹³è¡Œå…³ç³»</p>
</blockquote>
<h5 id="PromiseçŠ¶æ€"><a href="#PromiseçŠ¶æ€" class="headerlink" title="PromiseçŠ¶æ€"></a>PromiseçŠ¶æ€</h5><blockquote>
<p><strong>Promiseçš„çŠ¶æ€æ˜¯ä¸å¯é€†çš„ï¼Œä¸€æ—¦çŠ¶æ€å‘ç”Ÿæ”¹å˜å°±æ°¸è¿œæ— æ³•è¿˜åŸ(ä½ æ‰‹åŠ¨ä¹Ÿæ”¹ä¸äº†)</strong></p>
</blockquote>
<p>Promiseå¦‚ä½•ç®¡ç†å¼‚æ­¥ä»£ç ï¼Ÿ</p>
<p>å®ƒä¸ºæ¯ä¸€ä¸ªä»»åŠ¡éƒ½ç»´æŠ¤äº†ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œæˆ‘ä»¬å¯æ ¹æ®å¼‚æ­¥ä»£ç çš„æ‰§è¡Œç»“æœå»åŠ¨æ€æ”¹å˜Promiseçš„å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œå®ç°åç»­ä»£ç çš„è°ƒç”¨</p>
<p>(æ˜¯æˆ‘ä»¬æ‰‹åŠ¨æ”¹å˜çŠ¶æ€ï¼Œä¸æ˜¯Promiseè‡ªå·±ç»´æŠ¤çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸å»æ‰‹åŠ¨æ”¹ï¼Œ<strong>æ°¸è¿œéƒ½æ˜¯åˆå§‹çŠ¶æ€pending</strong>)</p>
<ul>
<li>pending - åˆå§‹çŠ¶æ€ æ—¢éæˆåŠŸ ä¹Ÿéå¤±è´¥ åœ¨ç­‰å¾…</li>
<li>resolved - æ“ä½œæˆåŠŸ é€šè¿‡resolve(xx)æ–¹æ³• ä¹‹åè°ƒç”¨thenæ–¹æ³•</li>
<li>rejected - æ“ä½œå¤±è´¥ é€šè¿‡reject(yy)æ–¹æ³• ä¹‹åè°ƒç”¨catchæ–¹æ³•</li>
</ul>
<p>resolveå’Œrejectå‡½æ•°è°ƒç”¨ç±»ä¼¼äº‹ä»¶å¯¹è±¡eventï¼Œéœ€è¦ä¼ å…¥è¿›new Promiseçš„å‚æ•°ä¸­æ‰å¯è°ƒç”¨ï¼</p>
<p>Promiseçš„çŠ¶æ€è¢«ä¿®æ”¹å å°±ä¼šè°ƒç”¨åç»­çš„thenã€catchæ–¹æ³• </p>
<p>Promiseä¸­çš„å¼‚æ­¥ä»»åŠ¡ä»€ä¹ˆæ—¶å€™ å¯ä»¥ç»§ç»­å‘ä¸‹æ‰§è¡Œ å…¨å‡­ä½ å©å’ çœ‹ä½ ä»€ä¹ˆæ—¶å€™æ”¹Promiseçš„çŠ¶æ€</p>
<p>(çœ‹ä½ ä»€ä¹ˆæ—¶å€™è°ƒresolveæˆ–rejectæ–¹æ³•)</p>
<p>ç‰¹æ®Šå†™æ³•ï¼šreturn Promise.resolve(xx) | return Promise.reject(yy)</p>
<p>è¿™ä¸ªå†™æ³•æ—¢æ”¹å˜äº†PromiseStatusä¹Ÿæ”¹å˜äº†PromiseValue</p>
<h5 id="Promiseå¯¹è±¡çš„thenæ–¹æ³•"><a href="#Promiseå¯¹è±¡çš„thenæ–¹æ³•" class="headerlink" title="Promiseå¯¹è±¡çš„thenæ–¹æ³•"></a>Promiseå¯¹è±¡çš„thenæ–¹æ³•</h5><p>thenæ–¹æ³•å¯æ¥æ”¶ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªè¡¨ç¤ºresolvedï¼Œç¬¬äºŒä¸ªè¡¨ç¤ºrejected</p>
<p>å¦‚æœåªæ¥æ”¶äº†ä¸€ä¸ªå‡½æ•° é‚£ä¹ˆå°±æ˜¯æˆåŠŸ</p>
<p>thenæ–¹æ³•çš„å‚æ•°å‡½æ•°åªèƒ½æ¥æ”¶ä¸€ä¸ªå€¼</p>
<p>let p1 = new Promise((resolve,reject)=&gt;{dosomething;resolve();})</p>
<p>p1.then(()=&gt;{},()=&gt;{})</p>
<p>å¦‚æœp1æ˜¯resolvedçŠ¶æ€åˆ™èµ°thenæ–¹æ³•ä¸­çš„ç¬¬ä¸€ä¸ªå‡½æ•°ä½“ï¼Œ</p>
<p>å¦‚æœp1æ˜¯rejectedçŠ¶æ€åˆ™èµ°thenæ–¹æ³•ä¸­çš„ç¬¬äºŒä¸ªå‡½æ•°ä½“ã€‚</p>
<p>ğŸ’¡æ³¨:</p>
<p>å¦‚æœåœ¨è°ƒç”¨resolve(par1)æˆ–reject(par2)æ–¹æ³•æ—¶ä¼ å…¥äº†å‚æ•°å€¼parï¼Œparå¯ä»¥è¢«ä¼ é€’åˆ°thenæ–¹æ³•ä¸­ä½¿ç”¨å“¦ï¼Œparå°±èµ‹ç»™äº†Promiseå†…éƒ¨çš„PromiseValue</p>
<p>p1.then(par1=&gt;{},par2=&gt;{})par1ä¸ºresolveçŠ¶æ€çš„PromiseValue,par2ä¸ºrejectedçŠ¶æ€çš„PromiseValue</p>
<p>==åŒä¸€ä¸ªPromiseå¯¹è±¡==çš„thenæ–¹æ³•éƒ½æ˜¯åŒçº§(ç›¸å½“äºå¹¶å‘æˆ–å¹¶è¡Œ)çš„ï¼Œç±»ä¼¼addEventListeneräº‹ä»¶æ³¨å†Œæœºåˆ¶</p>
<p>p1.then(xx=&gt;{yy1});p1.then(xx=&gt;{yy2})</p>
<blockquote>
<p><strong>thenæ–¹æ³•ä¹Ÿæ˜¯æœ‰é»˜è®¤è¿”å›å€¼çš„</strong></p>
<hr>
<p>p1å¯¹è±¡çš„thenæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡p2(ä¸åŒäºp1)</p>
<p><strong><em>å¤§å‘:</em></strong></p>
<p>ä¸€æ—¦ä½ è°ƒç”¨äº†thenæˆ–catchæ–¹æ³•è€Œä¸”é‡Œå¤´æœ‰ä¼ å‡½æ•°ä½œä¸ºå‚æ•°(å³ä½¿å‡½æ•°ä½“ä¸ºç©ºï¼)ï¼Œä½†ä½ æ²¡æœ‰æ‰‹åŠ¨return new Promiseå’Œåœ¨é‡Œå¤´æ›´æ”¹statuså’Œvalueçš„è¯</p>
<p>é‚£thenæˆ–catchä¹‹åä¸€å®šä¼šç»™ä½ è¿”å›è¿™ä¹ˆä¸€ä¸ªPromise: <resolved>: undefined</resolved></p>
<p>å› ä¸ºthenç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨resolve,è€Œcatchå…¶å®ç›¸å½“äºthen(undefined,xxx)</p>
<p>ä¸ä¿¡ä½ å»è¯•è¯• ä¾‹å¦‚p2 = p1.then(()=&gt;{},x=&gt;{console.log(x)})</p>
<p>p3=p2.catch(y=&gt;{console.log(y)})</p>
<p>==å°å‘==</p>
<p>å¦‚æœä½ åœ¨å‡½æ•°ä½“ç»“å°¾å†™äº†return 2;è¿”å›å€¼å¹¶ä¸æ˜¯2,è€Œæ˜¯</p>
<p>Promise {<resolved>: 2} æ²¡æƒ³åˆ°å§.</resolved></p>
<p>æ‰€ä»¥å¯ä»¥åŠ¨æ‰‹é€ ä¸€ä¸ªnew Promiseä½œä¸ºè¿”å›å€¼ï¼Œåœ¨è¿™ä¸ªnew Promiseä¸­æ ¹æ®éœ€æ±‚æ‰‹åŠ¨è®¾å®šçŠ¶æ€</p>
<p>åˆ‡è®°è¿™ä¸ªæ‰‹åŠ¨é€ çš„æ–°Promiseå¾—ä¼ å…¥å‚æ•°resolveæˆ–reject</p>
</blockquote>
<p>thenæ–¹æ³•å¯ä»¥é“¾å¼è°ƒç”¨ï¼Œæœ€å¥½æ¯ä¸ªthenä¸­éƒ½åŠ¨æ‰‹æ„é€ new Promiseä½œä¸ºè¿”å›å€¼ï¼Œæ ¹æ®éœ€æ±‚æ¥æ”¹å˜çŠ¶æ€ï¼Œ</p>
<p>ä½†æ˜¯æœ€åä¸€ä¸ªthenä¸éœ€è¦æ‰‹åŠ¨æ„é€ äº†ï¼Œå› ä¸ºåç»­æ²¡æœ‰è¦æ‰§è¡Œçš„ä»£ç äº†</p>
<h6 id="catch"><a href="#catch" class="headerlink" title="catch"></a>catch</h6><p>catchç›¸å½“äºthençš„ä¸€ç§ç‰¹æ®Šæƒ…å†µçš„ä¸€ä¸ªè¯­æ³•ç³– ä¹Ÿæ˜¯å¯ä»¥é“¾å¼è°ƒç”¨æ»´</p>
<p>p1.then(()=&gt;{},x=&gt;{y}) =&gt; p1.then(undefined,x=&gt;{y})</p>
<p>=&gt; p1.catch(x=&gt;{y}) éƒ½æ˜¯ç­‰ä»·çš„</p>
<p>æƒ³é“¾å¼è°ƒç”¨å¤šä¸ªcatch ä¸­é—´ä¸€å®šè¦æ‰‹åŠ¨è¿”å›new Promiseä¸”reject(val)</p>
<p>p1.catch(x=&gt;{}).catch(x=&gt;{}).catch(x=&gt;{});</p>
<h6 id="finally"><a href="#finally" class="headerlink" title="finally"></a>finally</h6><p>å¦‚æœä½ æƒ³åœ¨ promise æ‰§è¡Œå®Œæ¯•åæ— è®ºå…¶ç»“æœæ€æ ·éƒ½åšä¸€äº›å¤„ç†æˆ–æ¸…ç†æ—¶ï¼Œå¯ä»¥åœ¨é“¾å¼è°ƒç”¨æœ«å°¾ä½¿ç”¨finally</p>
<p>p1.then().then().finally(()=&gt;{})</p>
<h5 id="Promiseå¤šä»»åŠ¡å¤„ç†"><a href="#Promiseå¤šä»»åŠ¡å¤„ç†" class="headerlink" title="Promiseå¤šä»»åŠ¡å¤„ç†"></a>Promiseå¤šä»»åŠ¡å¤„ç†</h5><ul>
<li><p>Promise.all</p>
<p>å½“å‚æ•°ä¸­æ‰€æœ‰Promiseéƒ½åˆ°è¾¾äº†æˆåŠŸçŠ¶æ€(resolved)æ‰å¯ä»¥æ‰§è¡Œåç»­çš„then</p>
<p>ä¸€ä¸ªä»»åŠ¡ä¾èµ–å¤šä¸ªä»»åŠ¡çš„å¤„ç†ç»“æœæ—¶å¯ç”¨</p>
<p>let p1 = new Promise(xx;resolve(p1v)); let p2 = new Promise(yy;resolve(p2v));</p>
<p>Promise.all([p1,p2]).then(val=&gt;{//æ‹¿åˆ°p1å’Œp2ç»“æœåæ‰æ‰§è¡Œçš„ä»£ç })</p>
<p>thenä¸­çš„valå€¼ä¸ºæ•°ç»„ï¼Œæ•°ç»„å…ƒç´ ä¸ºå‰é¢å¼‚æ­¥ä»»åŠ¡çš„å€¼(å³p1å’Œp2 ä¼ ç»™resolveå‡½æ•°çš„å€¼)PromiseValue</p>
<p>val-&gt;[p1v,p2v]</p>
</li>
<li><p>Promise.race</p>
<p>å½“å‚æ•°ä¸­çš„Promiseä½†å‡¡æœ‰ä¸€ä¸ªåˆ°è¾¾äº†æˆåŠŸçŠ¶æ€(resolved)å°±å¯ä»¥æ‰§è¡Œåç»­çš„then</p>
<p>ä¸€ä¸ªä»»åŠ¡ä¾èµ–äºå¤šä¸ªä»»åŠ¡ä¸­ä»»æ„ä¸€ä¸ªå¤„ç†ç»“æœæ—¶å¯ç”¨</p>
<p>Promise.race([p1,p2]).then(v=&gt;{})</p>
<p>thenä¸­çš„vä»£è¡¨çš„æ˜¯æœ€å…ˆå®Œæˆçš„Promiseå¯¹è±¡çš„PromiseValue(p1å’Œp2ä¸­å…ˆå®Œæˆçš„é‚£ä¸ªä¼ ç»™resolveå‡½æ•°çš„å€¼)</p>
</li>
</ul>
<hr>
<p>thenä¸­å¤„ç†è¿”å›å€¼æ–¹æ¡ˆé€‰æ‹©(éœ€ä¸éœ€è¦æ‰‹åŠ¨returnæ–°Promiseå‘¢?)ï¼š</p>
<ol>
<li><p>thenä¸­æ²¡æœ‰å¼‚æ­¥ä»£ç |é€»è¾‘å¤„ç†æˆ–ä¸éœ€è¦å‘ä¸‹ä¼ å€¼äº†ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨thené»˜è®¤è¿”å›çš„promiseå³å¯</p>
<p>é»˜è®¤è¿”å›çš„promiseçš„çŠ¶æ€ç»§æ‰¿è‡ªä¸Šä¸ªpromiseçš„çŠ¶æ€(new Promiseè¿‡æ¥çš„æˆ–thenè¿‡æ¥çš„)</p>
</li>
<li><p>å¦‚æœthenä¸­æœ‰å¼‚æ­¥ä»£ç  æˆ–è€…éœ€è¦å‘ä¸‹ä¼ å€¼ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰‹åŠ¨è¿”å›new Promise</p>
</li>
</ol>
<ul>
<li><p>å¦‚æœä»…ä»…éœ€è¦ä¼ ä¸ªå€¼ ç®€æ´åœ°ç”¨return Promise.resolve(val)æˆ–Promise.reject(val) å³å¯</p>
</li>
<li><p>å¦‚æœé™¤äº†ä¼ å€¼å¯èƒ½è¿˜æœ‰æ›´å¤æ‚çš„å¼‚æ­¥ä»»åŠ¡å’Œé€»è¾‘è¦å¤„ç†ï¼Œå°±ä½¿ç”¨</p>
<p>return new Promise(resolve=&gt;{</p>
<p>//dosomething;</p>
<p>resolve(val)</p>
<p>})</p>
</li>
</ul>
<blockquote>
<p>å‡ æ®µä»£ç è¯»æ‡‚promiseç‰¹æ€§ <a href="https://www.jb51.net/article/119630.htm" target="_blank" rel="noopener">https://www.jb51.net/article/119630.htm</a></p>
</blockquote>
<h6 id="ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹-jså†…ç½®å±æ€§-prop-åŒæ–¹æ‹¬å·"><a href="#ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹-jså†…ç½®å±æ€§-prop-åŒæ–¹æ‹¬å·" class="headerlink" title="ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹:jså†…ç½®å±æ€§[[prop]] åŒæ–¹æ‹¬å·"></a>ğŸ’¡è¡¥å……çŸ¥è¯†ç‚¹:jså†…ç½®å±æ€§[[prop]] åŒæ–¹æ‹¬å·</h6><p>[[PromiseStatus]]å’Œ[[PromiseValue]]</p>
<p>å‡ä¸ºjså†…ç½®å±æ€§ï¼Œè¿™ç§åŒæ–¹æ‹¬å·å±æ€§æ— æ³•ç›´æ¥è¿›è¡Œè¯»æˆ–å†™æ“ä½œï¼Œåªèƒ½é€šè¿‡ç‰¹å®šæ–¹æ³•æ¥è¿›è¡Œè¯»å†™æ“ä½œã€‚</p>
<p>ç‰¹å®šæ–¹æ³•æ¥äº†:</p>
<p>Promise.resolve(1) å°±ç›¸å½“äºæŠŠpromiseçš„statusè®¾ç½®ä¸ºresolved,PromiseValueè®¾ä¸º1</p>
<p>æƒ³è¯»å–PromiseValueåªèƒ½ Promise.resolve(â€˜helloâ€™).then(res=&gt;{console.log(res)})</p>
<p>thenä¸­æ‰å¯ä»¥æ‰“å°å‡ºâ€˜helloâ€™</p>
<p>æˆ–è€…è¿™ç§å†™æ³•:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">'hello'</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(res);</span><br><span class="line">&#125;)()</span><br><span class="line"><span class="comment">//æ³¨æ„console.log(res)è¦ç´§è·Ÿåœ¨awaitåæ‰æœ‰æ•ˆ</span></span><br></pre></td></tr></table></figure>
<p>Promise.resolve() åˆ™ Promiseä¸º resolved:undefined</p>
<p>==æ³¨æ„==</p>
<p>var er = Promise.reject(â€˜err2â€™) ä¼šæ”¹å˜PromiseStatusä¸ºrejectedå’ŒPromiseValueä¸ºâ€˜errâ€™</p>
<p>ä½†æ˜¯ä¼šæŠ¥é”™ Uncaught (in promise) err2</p>
<p>è¿˜æ˜¯å¾—å¤„ç†ä¸‹é”™è¯¯</p>
<h5 id="asyncå’Œawait-å¾ˆç”œçš„è¯­æ³•ç³–"><a href="#asyncå’Œawait-å¾ˆç”œçš„è¯­æ³•ç³–" class="headerlink" title="asyncå’Œawait å¾ˆç”œçš„è¯­æ³•ç³–"></a>asyncå’Œawait å¾ˆç”œçš„è¯­æ³•ç³–</h5><p>è‹¥å°†å‡½æ•°å£°æ˜ä¸ºasyncï¼Œä¸€èˆ¬æ²¡å†™returnçš„å‡½æ•°åŸæœ¬é»˜è®¤è¿”å›undefinedï¼ŒåŠ äº†asyncå£°æ˜åé»˜è®¤è¿”å›å€¼ä¸ºPromiseå¯¹è±¡: Promise {<resolved>: undefined}</resolved></p>
<p>è‹¥åœ¨asyncå‡½æ•°æœ«å°¾return x ,è¿”å›çš„ä»ç„¶æ˜¯Promiseå¯¹è±¡</p>
<p>Promise {<resolved>: x}</resolved></p>
<p>awaitåé¢æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡</p>
<p>ç­‰å¾…Promiseçš„çŠ¶æ€å‘ç”Ÿæ”¹å˜(ä¸”éœ€è¦æ˜¯resolve) æ‰è¿›è¡Œåç»­æ“ä½œ awaitåé¢çš„å€¼ ä¼šè¢«èµ‹å€¼ç»™â€˜=â€™å·¦ä¾§çš„å˜é‡</p>
<p>awaitä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œéœ€è¦åœ¨asyncå‡½æ•°ä¸­ä½¿ç”¨</p>
<p>awaitåçš„Promiseå¯¹è±¡å¦‚æœrejectäº† é‚£æ•´ä¸ªasyncå‡½æ•°ä¼šä¸­æ–­æ‰§è¡Œ</p>
<p>è‹¥å¯èƒ½å˜ä¸ºrejectï¼Œéœ€è¦å°†awaitæ‰€åœ¨è¯­å¥æ”¾åœ¨try catchè¯­å¥ä¸­</p>
<p>å›è°ƒå‡½æ•° (err,result)=&gt;{}</p>
<p>æ¢awaitå†™çš„è¯ ç”¨try catchæ¥å¤„ç†</p>
<p>ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">     <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>);</span><br><span class="line">     <span class="built_in">console</span>.log(<span class="string">'ä¸Šé¢å·²ç»å‡ºé”™äº†'</span>);</span><br><span class="line">     <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">'hello world'</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(e);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>æ‰“å°å‡ºâ€˜å‡ºé”™äº†â€™ åé¢ä»£ç ä¸å†æ‰§è¡Œï¼›å¦‚æœä¸é€‚ç”¨try catchè¯­å¥ ä¼šçˆ†çº¢é”™è¯¯</p>
<p>âŒ Uncaught (in promise) å‡ºé”™äº†</p>
<p>æ³¨æ„ğŸ’¡</p>
<p>let foo = await getFoo();</p>
<p>let bar = await getBar();</p>
<p>è¿™ç§å†™æ³•æ˜¯ä¼šé¡ºåºæ‰§è¡Œçš„ barä¼šç­‰fooæ‹¿åˆ°ä¹‹åå†æ‹¿ </p>
<p>(å¦‚æœthenæ˜¯è¿™ç§å†™æ³• p1.thenxxx;p1.thenyyy;åˆ™æ˜¯å¹¶å‘æ‰§è¡Œ)</p>
<p>è¿™æ—¶å°±é Promise.alläº†</p>
<p>let [foo, bar] = await Promise.all([getFoo(), getBar()]);</p>
<p>è¿™ä¸ªæ—¶å€™fooå’Œbarå°±æ˜¯ä¼šå¹¶å‘æ‰§è¡Œäº† ä¸¤ä¸ªPromiseåŒ…æˆäº†ä¸€ä¸ª</p>
<p>ä½†æ˜¯ä¼šç­‰åˆ°ä¸¤ä¸ªç»“æœéƒ½æ‹¿åˆ°</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">superman285</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://skr.dog/2019/01/02/Promiseæ‰‹æœ­/">https://skr.dog/2019/01/02/Promiseæ‰‹æœ­/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JavaScript/">JavaScript</a><a class="post-meta__tags" href="/tags/Promise/">Promise</a></div><div class="social-share" data-disabled="douban,heart,tencent,qzone,linkedin,diandian"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/01/03/MySqlç®€å•ä½¿ç”¨å¤‡æ³¨/"><i class="fa fa-chevron-left">  </i><span>MySqlç®€å•ä½¿ç”¨å¤‡æ³¨</span></a></div><div class="next-post pull-right"><a href="/2018/12/25/gitå¸¸ç”¨æŠ€èƒ½ç‚¹/"><span>gitå¸¸ç”¨æŠ€èƒ½ç‚¹</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'ab689454493850e68d9d',
  clientSecret: '0f6ef510c8c9083679f478cadd47fed8361f3a51',
  repo: 'superman285.github.io',
  owner: 'superman285',
  admin: 'superman285',
  id: md5(decodeURI(location.pathname)),
  language: ''
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/02/22/5c6f8ab4867b6.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By superman285</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="icp"><a><span>ç²¤ICPå¤‡19022229å·-1</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="please input what you want"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>