<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="Solidityå­¦ä¹ ç¬”è®°"><meta name="keywords" content="Ethereum,Solidity,BlockChain,æ™ºèƒ½åˆçº¦"><meta name="author" content="superman285"><meta name="copyright" content="superman285"><title>Solidityå­¦ä¹ ç¬”è®° | Superman285ã®Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js"></script><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script><link rel="dns-prefetch" href="https://hm.baidu.com"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f95f9792a34045b9d58c63113e1af8d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="Toggle article">Toggle site</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#é€šè¯†"><span class="toc-number">1.</span> <span class="toc-text">é€šè¯†</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#åŸºæœ¬ç±»å‹"><span class="toc-number">2.</span> <span class="toc-text">åŸºæœ¬ç±»å‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#æ•´æ•°"><span class="toc-number">3.</span> <span class="toc-text">æ•´æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å¼•ç”¨ç±»å‹"><span class="toc-number">4.</span> <span class="toc-text">å¼•ç”¨ç±»å‹</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#æ•°æ®ä½ç½®"><span class="toc-number">5.</span> <span class="toc-text">æ•°æ®ä½ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å†…å»ºå¯¹è±¡"><span class="toc-number">6.</span> <span class="toc-text">å†…å»ºå¯¹è±¡</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å†…ç½®å‡½æ•°"><span class="toc-number">7.</span> <span class="toc-text">å†…ç½®å‡½æ•°</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#éšæœºæ•°ç”Ÿæˆæ–¹æ³•"><span class="toc-number">8.</span> <span class="toc-text">éšæœºæ•°ç”Ÿæˆæ–¹æ³•</span></a></li></ol><li class="toc-item toc-level-4"><a class="toc-link" href="#å‡½æ•°"><span class="toc-number"></span> <span class="toc-text">å‡½æ•°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#å‡½æ•°å£°æ˜"><span class="toc-number">1.</span> <span class="toc-text">å‡½æ•°å£°æ˜</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å‡½æ•°ä¿®é¥°ç¬¦"><span class="toc-number">2.</span> <span class="toc-text">å‡½æ•°ä¿®é¥°ç¬¦</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#å¯è§æ€§-ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼"><span class="toc-number">2.1.</span> <span class="toc-text">å¯è§æ€§ ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#require-assert-revert"><span class="toc-number">3.</span> <span class="toc-text">require assert revert</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#äº‹ä»¶"><span class="toc-number">4.</span> <span class="toc-text">äº‹ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#æ•°ç»„"><span class="toc-number">5.</span> <span class="toc-text">æ•°ç»„</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#å­—ç¬¦ä¸²"><span class="toc-number">6.</span> <span class="toc-text">å­—ç¬¦ä¸²</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#web3-js"><span class="toc-number">7.</span> <span class="toc-text">web3.js</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#At-Address-åŠ è½½å·²éƒ¨ç½²åˆçº¦"><span class="toc-number">7.1.</span> <span class="toc-text">At Address åŠ è½½å·²éƒ¨ç½²åˆçº¦</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#importå¼•å…¥çš„ç”¨æ³•"><span class="toc-number">8.</span> <span class="toc-text">importå¼•å…¥çš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#åº“libraryçš„ç”¨æ³•"><span class="toc-number">9.</span> <span class="toc-text">åº“libraryçš„ç”¨æ³•</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#solidity-0-5-0é‚£äº›äº‹"><span class="toc-number">10.</span> <span class="toc-text">solidity 0.5.0é‚£äº›äº‹</span></a></li></ol></li></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://i.loli.net/2019/02/21/5c6e32e5dbb4a.jpg"></div><div class="author-info__name text-center">superman285</div><div class="author-info__description text-center"></div><div class="follow-button"><a href="https://github.com/superman285">Git Me Follow</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">47</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">44</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">22</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">FriendLinks</div><a class="author-info-links__name text-center" href="http://skrgame.fun">TicTacToe</a><a class="author-info-links__name text-center" href="http://superskr.top">SkrWallet</a><a class="author-info-links__name text-center" href="http://superskr.fun">KoaNotes</a><a class="author-info-links__name text-center" href="http://skrnote.top">ETH-SkrNote</a><a class="author-info-links__name text-center" href="https://molunerfinn.com/hexo-theme-melody-doc/zh-Hans">Beauty Hexo-Theme</a><a class="author-info-links__name text-center" href="https://minimalwang.xyz">ä¸€ä¸ªæ¸…æ–°è„±ä¿—çš„å‰ç«¯</a></div></div><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="280" height="80" src="//music.163.com/outchain/player?type=2&amp;id=583503&amp;auto=1&amp;height=66" style="margin-top: 2rem;"></iframe><div class="unit"><div class="heart"><div class="heart-piece-0"></div><div class="heart-piece-1"></div><div class="heart-piece-2"></div><div class="heart-piece-3"></div><div class="heart-piece-4"></div><div class="heart-piece-5"></div><div class="heart-piece-6"></div><div class="heart-piece-7"></div><div class="heart-piece-8"></div></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://i.loli.net/2019/02/22/5c6f8ab4867b6.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Superman285ã®Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page social-icon search"><i class="fa fa-search"></i><span> Search</span></a><a class="site-page" href="/">é¦–é¡µ</a><a class="site-page" href="/archives">æ—¶å…‰æœº</a><a class="site-page" href="/tags">æ ‡ç­¾</a><a class="site-page" href="/categories">åˆ†ç±»</a><a class="site-page" href="/categories/BlockChain">åŒºå—é“¾</a><a class="site-page" href="/categories/Entertain">å¨±ä¹</a><a class="site-page" href="/Works">ä½œå“é›†</a></span></div><div id="post-info"><div id="post-title">Solidityå­¦ä¹ ç¬”è®°</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-01-26</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/BlockChain/">BlockChain</a><i class="fa fa-angle-right" aria-hidden="true"></i><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/BlockChain/Solidity/">Solidity</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h5 id="é€šè¯†"><a href="#é€šè¯†" class="headerlink" title="é€šè¯†"></a>é€šè¯†</h5><p>ä¸€ä¸ªå­—èŠ‚å¯¹åº”8ä½(8ä¸ªäºŒè¿›åˆ¶ä½) 1B(Byte)å¯¹åº”8b(bit)</p>
<p>ä¸€ä¸ªåå…­è¿›åˆ¶ä½å¯¹åº”4ä¸ªäºŒè¿›åˆ¶ä½(2^4^=16)</p>
<p>æ‰€ä»¥==ä¸€ä¸ªå­—èŠ‚å¯¹åº”2ä¸ªåå…­è¿›åˆ¶ä½==</p>
<p>bytes32 32å­—èŠ‚é•¿ï¼Œå¯¹åº”64ä½åå…­è¿›åˆ¶æ•° å³256bit</p>
<p>address 20å­—èŠ‚é•¿ï¼Œå¯¹åº”40ä½åå…­è¿›åˆ¶æ•°ã€160ä½äºŒè¿›åˆ¶ï¼Œç›¸å½“äºuint160ã€‘</p>
<p>åœ°å€æ˜¯ address é•¿åº¦ä¸º40ä½(åŠ ä¸Šå¼€å¤´0xå°±42ä½)</p>
<p>ç§é’¥|å…¬é’¥ bytes32 é•¿åº¦ä¸º64ä½</p>
<h5 id="åŸºæœ¬ç±»å‹"><a href="#åŸºæœ¬ç±»å‹" class="headerlink" title="åŸºæœ¬ç±»å‹"></a>åŸºæœ¬ç±»å‹</h5><p>string å­—ç¬¦ä¸²ï¼Œutf-8ç¼–ç </p>
<p>bool</p>
<p>int æœ‰ç¬¦å·æ•´æ•°</p>
<p>uint æ— ç¬¦å·æ•´æ•°</p>
<p>address 16è¿›åˆ¶ï¼Œä¸€å…±æœ‰40ä½æ•°(ä¸åŒ…æ‹¬å¼€å¤´0x)</p>
<h5 id="æ•´æ•°"><a href="#æ•´æ•°" class="headerlink" title="æ•´æ•°"></a>æ•´æ•°</h5><p>uint8 8ä½æ— ç¬¦å·æ•´æ•°ï¼Œ0~2^8^-1(255)</p>
<p>uint16</p>
<p>â€¦</p>
<p>uint256</p>
<p>ä»¥8ä¸ºæ­¥é•¿ï¼Œuintç›¸å½“äºuint256</p>
<p>intç±»ä¼¼</p>
<h5 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h5><p>int[8] å®šé•¿æ•°ç»„</p>
<p>type[] åŠ¨æ€æ•°ç»„(å¤šç§ç±»å‹)ï¼Œlengthé•¿åº¦ï¼ŒpushåŠ å…¥å…ƒç´ </p>
<p>struct ç»“æ„ä½“ <strong>å¯è§æ€§åªèƒ½ä¸ºinternal,ä¸æ”¯æŒè‡ªå·±å£°æ˜</strong></p>
<p>mapping(key =&gt; value) æ˜ å°„è¡¨ (å³kvé”®å€¼å¯¹) mapping(type1=&gt;type2) map; map[key]å¯¹åº”value</p>
<blockquote>
<p>ã€Œå¦‚ä½•åˆ¤æ–­æŸä¸ªkeyæ˜¯å¦å­˜åœ¨mappingä¸­ã€ï¼Œå…¶å®æ˜¯ä¸ºäº†è¾“å…¥ä¸åˆæ³•çš„keyæ—¶èƒ½ç»™ä¸æç¤ºï¼Œå¦åˆ™åªæ˜¯è¿”å›ç¼ºçœå€¼æˆ–è€…æ²¡ååº” è‚¯å®šä¸åˆé€‚ã€‚</p>
<p>å…·ä½“å¯è§åˆçº¦HMS/InfoManagement.sol</p>
<p>æœ‰ä¸ªæ¯”è¾ƒè€—gasçš„æ–¹æ³•</p>
<p>æŠŠmappingçš„valueä¹Ÿåšä¸€ä¸ªæ•°ç»„ï¼Œvalue[] values;æ•°ç»„ä¸­éœ€è¦æœ‰mapçš„key(å³id)</p>
<p>ä¼ å…¥å‚æ•°ä¸ºinput_id</p>
<p>for(uint i=0;i&lt;values.length;i++){</p>
<p>â€‹    if(input_id==values[i].id){åˆ™è¯´æ˜input_idç¡®å®å­˜åœ¨äºmappingä¸­çš„}</p>
<p>}</p>
</blockquote>
<blockquote>
<p>ğŸ’¡ç‰¹åˆ«æ³¨æ„ï¼š</p>
<p>==!!!!å…¥å‚å’Œå‡ºå‚æ”¯æŒç»“æ„ä½“ï¼Œç»“æ„ä½“æ•°ç»„ï¼Œæ•°ç»„ï¼Œæ˜ å°„!!!!==  0.5.0  666</p>
<p>æƒ³æ”¯æŒç»“æ„ä½“æˆ–ç»“æ„ä½“æ•°ç»„ å¼€å¤´è¦æ·»åŠ pragma experimental ABIEncoderV2;</p>
<p>ä¼ å…¥æˆ–è¿”å›æ˜ å°„çš„å†™æ³• returns(mapping(uint=&gt;uint) memory(æˆ–storage))</p>
<p>åˆ‡è®°ä¼ å…¥æˆ–è¿”å›æ˜ å°„åªèƒ½åœ¨==internalæ–¹æ³•==æˆ–==libraryåº“æ–¹æ³•==ä¸­</p>
<p>ä¼ å…¥æˆ–è¿”å›æ•°ç»„returns(uint[] memory) å½“å¯è§æ€§ä¸ºinternalæ—¶ï¼Œå¯ä¸ºstorage(å°‘ç”¨)</p>
<p>ä¼ å…¥æˆ–è¿”å›ç»“æ„ä½“returns(structName memory)  å½“å¯è§æ€§ä¸ºinternalæ—¶ï¼Œå¯ä¸ºstorage(å°‘ç”¨)</p>
<p>ä¼ å…¥æˆ–è¿”å›ç»“æ„ä½“æ•°ç»„returns(structName[] memory) å½“å¯è§æ€§ä¸ºinternalæ—¶ï¼Œå¯ä¸ºstorage(å°‘ç”¨)</p>
<p>å…·ä½“å¯è§HMS/InfoManagement.solï¼Œæ‹¿æ–¹æ³•getCustomerIDs()æ¥è¯•éªŒ</p>
</blockquote>
<p>==ç»“æ„ä½“==</p>
<p>ç›®å‰å¯èƒ½æ€§åªèƒ½ä¸ºinternalï¼Œè€Œä¸”ä¸èƒ½æ˜¾ç¤ºåœ°å†™å‡ºæ¥!</p>
<p>struct CustomerInfo</p>
<p>mapping(uint=&gt;CustomerInfo) cinfos</p>
<p>åˆ‡è®°æ•°ç»„æ·»åŠ å…ƒç´ å¿…é¡»ç”¨pushï¼Œä¸èƒ½array[1]=xxx,array[2]=xxx,ä¸æ˜¯mapping,æ˜¯åºåˆ—åŒ–çš„ï¼Œä¸€å®šè¦ä¸€ä¸ªä¸ªæ¥ï¼</p>
<p>ç»“æ„ä½“æ·»åŠ å¯ä»¥structA.name=xxx</p>
<p>mappingæ·»åŠ å¯ä»¥ address[name]=â€œmyNameâ€</p>
<p>ç»“æ„ä½“ä¸¤ç§èµ‹å€¼æ–¹å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CustomerInfo memory hotelAdmin = CustomerInfo(&#123;</span><br><span class="line">    customerName:<span class="string">"Administrator"</span>,</span><br><span class="line">    customerID:customers.length,</span><br><span class="line">    customerAge:<span class="number">666</span>,</span><br><span class="line">    isCrime:<span class="literal">false</span>&#125;);</span><br><span class="line">CustomerInfo memory hotemAdmin = CustomerInfo(<span class="string">"Admin"</span>,<span class="number">1</span>,<span class="number">666</span>,<span class="literal">false</span>);</span><br></pre></td></tr></table></figure>
<p>æ–°å»ºç»“æ„ä½“å¿…é¡»åŠ memoryï¼Œå› ä¸ºæ–°å»ºçš„ç»“æ„ä½“æœªå±äºçŠ¶æ€å˜é‡ã€‚</p>
<p>è‹¥æ˜¯å°†å·²ç»å­˜åœ¨çš„çŠ¶æ€å˜é‡ç»“æ„ä½“èµ‹å€¼ç»™æ–°å£°æ˜çš„ç»“æ„ä½“ï¼Œå¯ä»¥ç”¨storage</p>
<p>å¦‚ CustomerInfo storage newguest = customers[0];</p>
<p>ğŸ’¡tips: æ–°å»ºç»“æ„ä½“ä¸æ˜¯storageï¼Œæ— æ‰€è°“å•Šï¼ŒæŠŠä»–æ·»åŠ è¿›å±äºçŠ¶æ€å˜é‡çš„æŸä¸ªæ•°ç»„é‡Œå¤´ï¼Œä»–å°±æˆçŠ¶æ€å˜é‡å•¦ã€‚</p>
<p>solidityç»“æ„ä½“åˆå§‹åŒ– ä¸éœ€è¦new ä¸åƒjs</p>
<p>Person ap = Person(172,â€˜Satoshiâ€™);</p>
<p>==bytes== åŠ¨æ€åˆ†é…å¤§å°çš„å­—èŠ‚æ•°ç»„</p>
<p>bytes byt; byt.length byt[0]ï¼Œå¯è®¿é—®é•¿åº¦å’ŒæŸä¸ªä¸‹æ ‡</p>
<p>bytes32 å­—èŠ‚æ•°ç»„</p>
<p>bytes32 å†™ä¸€ä¸ªçš„æ—¶å€™å¯ä»¥ç®€å†™0x1234ï¼Œå¿…é¡»ä¸º==å¶æ•°ä½==ï¼Œåé¢è‡ªåŠ¨è¡¥0</p>
<p>ğŸ’¡åˆå§‹åŒ–æ•°ç»„æ–¹æ³•ï¼š</p>
<p>uint[] memory values = new uint[](3);</p>
<p>å†…å­˜æ•°ç»„å¿…é¡»ç”¨é•¿åº¦å‚æ•°åˆ›å»ºï¼Œåˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º3çš„æ•°ç»„</p>
<p>éœ€è¦è¯•ä¸€è¯•5.0ä¸­çš„æœ€æ–°æ”¹åŠ¨</p>
<h5 id="æ•°æ®ä½ç½®"><a href="#æ•°æ®ä½ç½®" class="headerlink" title="æ•°æ®ä½ç½®"></a>æ•°æ®ä½ç½®</h5><p>storage ä¿å­˜åœ¨çŠ¶æ€æ ‘ä¸­ï¼Œæˆå‘˜å˜é‡ä¸€èˆ¬ä½äºæ­¤å¤„|å…¨å±€å˜é‡</p>
<p>memory å‚æ•°ã€å±€éƒ¨å˜é‡ä¸€èˆ¬ä½äºæ­¤å¤„</p>
<p>æœ‰çš„å˜é‡å¯ä»¥ä½¿ç”¨ä¿®é¥°ç¬¦æ¥æ”¹å˜å˜é‡ä½ç½®ï¼Œä½†æ˜¯==çŠ¶æ€å˜é‡ä¸å¯æ”¹å˜ä½ç½®==ã€‚</p>
<p>ä¸¤ä¸ªä¸åŒä½ç½®çš„å¼•ç”¨å˜é‡ï¼Œä¼šå¯¼è‡´æ·±æ‹·è´è­¦å‘Š</p>
<p>memory å€¼ä¼ é€’ï¼Œæ‹·è´ï¼Œä¸æ”¹å˜æºæ•°æ®</p>
<p>storage å¼•ç”¨ä¼ é€’ï¼Œç›¸å½“äºæŒ‡é’ˆï¼Œä¼šæ”¹å˜æºæ•°æ®</p>
<p>å¼ºåˆ¶æŒ‡å®šçš„æ•°æ®ä½ç½®ï¼š</p>
<ul>
<li>å¤–éƒ¨å‡½æ•°çš„å‚æ•°ï¼ˆä¸åŒ…æ‹¬è¿”å›å‚æ•°ï¼‰ï¼š calldata</li>
<li>çŠ¶æ€å˜é‡ï¼š storage</li>
</ul>
<p>é»˜è®¤æ•°æ®ä½ç½®ï¼š</p>
<ul>
<li>å‡½æ•°å‚æ•°ï¼ˆåŒ…æ‹¬è¿”å›å‚æ•°ï¼‰ï¼š memory</li>
<li>æ‰€æœ‰å…¶å®ƒå±€éƒ¨å˜é‡ï¼š storage</li>
</ul>
<blockquote>
<p>å‡½æ•°å‚æ•°é»˜è®¤ä¸ºmemoryï¼Œæƒ³æ˜¾ç¤ºå£°æ˜æ•°æ®ä½ç½®çš„åªèƒ½ä¸ºstruct|array|mapping</p>
<p>ä¸‰ç§æ•°æ®ç±»å‹ï¼Œå…¶ä»–æ•°æ®ç±»å‹éƒ½ä¸å¯åŠ memoryæˆ–storageå£°æ˜</p>
<p>æœ€æ–°ç‰ˆæœ¬ï¼stringç±»å‹çš„å‡½æ•°å‚æ•°éœ€è¦æ˜¾ç¤ºå¢åŠ memoryå£°æ˜</p>
</blockquote>
<p>æ³¨æ„ğŸ’¡: ==å‡½æ•°ä¸­ç»“æ„ä½“å’Œæ•°ç»„çš„å£°æ˜å’Œèµ‹å€¼==éœ€è¦æ˜¾ç¤ºæ ‡ä¸ºstorageæˆ–è€…memoryï¼Œä¸å£°æ˜ä¼šæŠ¥warning(é»˜è®¤ä¸ºstorage),è€Œå…¶ä»–ç±»å‹(åŒ…æ‹¬mapping)éƒ½ä¸èƒ½å¸¦storageæˆ–memoryå£°æ˜ã€‚</p>
<p>å‡½æ•°ä¸­æ— æ³•å£°æ˜ä¸´æ—¶mappingï¼Œmappingä¸€å®šä¼šä½œä¸ºçŠ¶æ€å˜é‡å­˜åœ¨çš„ï¼Œå‡½æ•°ä¸­å£°æ˜mappingä¹Ÿéœ€è¦åˆå§‹åŒ–è€Œä¸”è¦å°†ä¸€ä¸ªçŠ¶æ€å˜é‡mapping(A)èµ‹å€¼ç»™ä»–ï¼Œè¿™æ—¶ç”¨å£°æ˜çš„mappingç›¸å½“äºåœ¨ç”¨mappingAäº†ã€‚</p>
<p>åˆçº¦ä¸­å‡½æ•°å¤–çš„å£°æ˜éƒ½æ˜¯çŠ¶æ€å˜é‡ï¼Œéƒ½å­˜åœ¨storageä¸­ï¼Œä¸èƒ½æ˜¾ç¤ºåŠ ä¸Šmemoryæˆ–storageå£°æ˜ã€‚</p>
<p>Person p = persons[_index];<br>p.age = _age;</p>
<p>//æ”¹å˜ageä¼šå½±å“åŸæ¥çš„å€¼</p>
<p>Person memory p = persons[_index];<br>p.age = _age;</p>
<p>//æ”¹å˜ageä¸ä¼šå½±å“åŸæ¥çš„å€¼</p>
<p>ä¾‹å­ï¼š<a href="https://cryptozombies.io/zh/lesson/3/chapter/12" target="_blank" rel="noopener">https://cryptozombies.io/zh/lesson/3/chapter/12</a></p>
<p>æ‰¹é‡åˆ é™¤æ•°ç»„å…ƒç´ ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§ç¬¦åˆç›´è§‰ï¼Œä½†æ˜¯ç‰¹åˆ«è´¹gas</p>
<ul>
<li><p>æ–¹æ³•éœ€è¦ä¼ å…¥storageæ•°ç»„å‚æ•°ï¼Œæ•°ç»„çš„åˆ é™¤é¡¹åé¢çš„æ¯ä¸ªé¡¹éƒ½å¾€å‰æŒªä¸€ä½(å³é‡æ–°èµ‹å€¼)ï¼Œç„¶åå†å°†æ•°ç»„é•¿åº¦å‡1ã€‚</p>
<p>å› ä¸ºéœ€è¦ä¿®æ”¹storageå˜é‡ï¼Œæ¯åŠ¨ä¸€é¡¹éƒ½è¦æ¶ˆè€—gasï¼Œè´µ</p>
</li>
<li><p>æ–¹æ³•äºŒ:ç”±äºå¤–éƒ¨è°ƒç”¨viewå‡½æ•°å…è´¹ï¼Œå¯ä»¥ç”¨forå¾ªç¯éå†æ•´ä¸ªæ•°ç»„æŠŠç¬¦åˆè¦æ±‚çš„æŒ‘å‡ºæ¥æ„å»ºå‡ºæ•°ç»„ï¼Œè¿™æ ·ä¼šä¾¿å®œçš„å¤šå¾—å¤šã€‚(éœ€è¦åšifåˆ¤æ–­)</p>
</li>
</ul>
<p>æ‰¹é‡èµ‹å€¼</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">uint a;</span><br><span class="line">uint b;</span><br><span class="line">uint c;</span><br><span class="line"><span class="comment">// è¿™æ ·æ¥åšæ‰¹é‡èµ‹å€¼:</span></span><br><span class="line">(a, b, c) = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h5 id="å†…å»ºå¯¹è±¡"><a href="#å†…å»ºå¯¹è±¡" class="headerlink" title="å†…å»ºå¯¹è±¡"></a>å†…å»ºå¯¹è±¡</h5><p>==<strong>block</strong>==</p>
<p>block.blockhash(uint blockNumber) returns (bytes32) æŒ‡å®šå—çš„å“ˆå¸Œ</p>
<p>block.coinbase (address) å½“å‰å—çŸ¿å·¥åœ°å€</p>
<p>block.difficulty (uint) å½“å‰å—éš¾åº¦å€¼</p>
<p>block.gaslimit (uint) å½“å‰å—gaslimit</p>
<p>block.number (uint) å½“å‰å—å—å·(åŒºå—é«˜åº¦)</p>
<p>block.timestamp (uint) å½“å‰å—æ—¶é—´æˆ³</p>
<p>==<strong>msg</strong>==</p>
<p>è°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼šç»™æ–¹æ³•ä¼ é€’ä¸€ä¸ªmsgå±æ€§</p>
<p>msg.data (byte) å®Œæ•´çš„calldata</p>
<p>msg.gas (uint) å‰©ä½™gas</p>
<p>msg.sender (address)å½“å‰æ¶ˆæ¯çš„å‘é€è€…</p>
<p>msg.sig (bytes4) å‘¼å«æ•°æ®çš„å‰å››ä¸ªå­—èŠ‚(å³åŠŸèƒ½æ ‡è¯†ç¬¦)</p>
<p>msg.value (uint) å‘é€çš„æ¶ˆæ¯çš„æ•°é‡(å‘é€çš„tokenæ•°é‡)</p>
<p>==now==</p>
<p>å³block.timestapçš„åˆ«å å½“å‰å—æ—¶é—´æˆ³</p>
<p>==address==</p>
<p>\&lt;address>.balance</p>
<p>\&lt;address>.transfer(uint256 amount) å‘é€æŒ‡å®šæ•°é‡etheråˆ°åœ°å€ï¼Œå¤±è´¥æ—¶æŠ›å¼‚å¸¸ï¼Œ</p>
<p>\&lt;address>.send(uint256 amount) returns (bool)  </p>
<p>å‘é€æŒ‡å®šæ•°é‡etheråˆ°åœ°å€ï¼Œå¤±è´¥æ—¶è¿”å›false</p>
<p>\&lt;address>.call(â€¦) returns (bool)</p>
<p>\&lt;address>.callcode(â€¦) returns (bool)</p>
<p>\&lt;address>.delegatecall(â€¦) returns (bool)</p>
<p>getBalance()æ–¹æ³•</p>
<p>return this.balance;</p>
<p>æ›´å®‰å…¨çš„å†™æ³•æ˜¯return address(this).balance;</p>
<p>thisä»£è¡¨å½“å‰åˆçº¦çš„åœ°å€ï¼Œåˆçº¦åœ°å€ï¼</p>
<p>msg.senderä»£è¡¨å½“å‰è°ƒç”¨äººçš„åœ°å€ï¼Œå¤–éƒ¨è´¦æˆ·åœ°å€ï¼</p>
<p>==tx==</p>
<ul>
<li><p><strong>tx.gasprice (uint)</strong>  gasä»·æ ¼</p>
</li>
<li><p><strong>tx.origin (address)</strong> äº¤æ˜“çš„å‘é€è€…ï¼ˆå…¨è°ƒç”¨é“¾ï¼‰</p>
<p>Solidityæœ‰ä¸€ä¸ªå…¨å±€å˜é‡tx.originï¼Œå®ƒéå†æ•´ä¸ªè°ƒç”¨å †æ ˆï¼Œå¹¶è¿”å›åŸå…ˆå‘é€è°ƒç”¨ï¼ˆæˆ–äº‹åŠ¡ï¼‰çš„å¸æˆ·åœ°å€ã€‚</p>
<p>å¦‚æœä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨è€…è§„å®šå¿…é¡»ä¸ºå¤–éƒ¨è´¦æˆ·ï¼Œç„¶è€Œè¿™ä¸ªåˆçº¦Bæ˜¯è¢«å…¶ä»–åˆçº¦Aéƒ¨ç½²çš„ï¼Œè¿™æ—¶ç”¨msg.senderä¼šè·å¾—å¤–éƒ¨è´¦æˆ·åœ°å€è€Œä¸æ˜¯åˆçº¦åœ°å€ï¼Œå¦‚æœä½¿ç”¨tx.originåˆ™å¯ä»¥è·å¾—æœ€å…ˆéƒ¨ç½²åˆçº¦Açš„å¤–éƒ¨è´¦æˆ·çš„åœ°å€äº†ã€‚</p>
<p>ä¸è¿‡è¦æ³¨æ„å®‰å…¨é—®é¢˜ï¼Œä¸€èˆ¬è¾ƒå°‘ä½¿ç”¨ã€‚</p>
<p>æœ‰ä¸€ä¸ªåˆ¤æ–­require(msg.sender==tx.origin)ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿ</p>
</li>
</ul>
<h5 id="å†…ç½®å‡½æ•°"><a href="#å†…ç½®å‡½æ•°" class="headerlink" title="å†…ç½®å‡½æ•°"></a>å†…ç½®å‡½æ•°</h5><p>addmod(uint x,uint y,uint k) returns (uint) (x+y)%k</p>
<p>mulmod(uint x,uint y,uint k) returns (uint) (x*y)%k</p>
<p>keccak256(â€¦) returns(bytes32)</p>
<p>å˜å‚ï¼Œå¯ä¼ å¤šä¸ªå‚æ•°</p>
<p>sha3 keccak256åˆ«å</p>
<p>assert(bool condition)</p>
<p>require(bool condition)</p>
<p>revert();</p>
<p>assertæ¯”è¾ƒè‡ªä¿¡ï¼Œæ–­è¨€æ­¤äº‹ä¸å‘ç”Ÿï¼Œå‘ç”Ÿä¼šæƒ©ç½š æ‰£å…‰æ‰€æœ‰gas</p>
<p>requireæ¯”è¾ƒæ¸©å’Œï¼Œå¦‚æœæ¡ä»¶ä¸æ»¡è¶³ï¼Œé€€å›å‰©ä½™gasï¼Œç”¨çš„æ›´å¤š</p>
<p>revertä¸»åŠ¨é€€å›gasï¼Œif/elseåˆ¤æ–­åä½¿ç”¨</p>
<p>assertå¤šç”¨äºåˆ¤æ–­éçŠ¶æ€å˜é‡</p>
<p>assertå¯è€ƒè™‘æ”¾åœ¨å‡½æ•°ç»“å°¾éƒ¨åˆ†ç”¨äºéªŒè¯ä¹‹å‰çš„æ“ä½œç»“æœçš„æ­£ç¡®æ€§</p>
<p>solidityå†…éƒ¨æœ‰thisï¼Œaddress(this)</p>
<p>selfdestruct(address) é”€æ¯åˆçº¦ï¼Œaddressæ˜¯æ”¶ç›Šäºº(é”€æ¯åé’±è½¬ç»™)</p>
<h5 id="éšæœºæ•°ç”Ÿæˆæ–¹æ³•"><a href="#éšæœºæ•°ç”Ÿæˆæ–¹æ³•" class="headerlink" title="éšæœºæ•°ç”Ÿæˆæ–¹æ³•"></a>éšæœºæ•°ç”Ÿæˆæ–¹æ³•</h5><p>keccak256å‡½æ•°ï¼š</p>
<p>uint random = uint(keccak256(block.difficulty,now));</p>
<p>blockhashæ³•:</p>
<p>uint random = uint(block.blockhash(block.number-1)); //ï¼Ÿå¾…æŸ¥</p>
<p>ä¸åƒjsï¼Œå˜é‡çš„èµ‹å€¼|å‡½æ•°çš„æ‰§è¡Œ ä¸èƒ½ç›´æ¥å†™åœ¨åˆçº¦ä¸­çš„ï¼Œè€Œæ˜¯å†™åœ¨å‡½æ•°ä¸­ï¼Œè¿™äº›æ“ä½œæ˜¯å¯èƒ½éœ€è¦æ¶ˆè€—gasçš„ã€‚æˆ–è€…å†™åœ¨jsä¸­ï¼Ÿ</p>
<h4 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h4><h5 id="å‡½æ•°å£°æ˜"><a href="#å‡½æ•°å£°æ˜" class="headerlink" title="å‡½æ•°å£°æ˜"></a>å‡½æ•°å£°æ˜</h5><p>å®šä¹‰</p>
<p>ä¿®é¥°</p>
<p>è°ƒç”¨</p>
<p>è¿”å›å€¼(å¯ä»¥å¤šä¸ªï¼Œ<strong><em>æœ€å¤š7ä¸ª</em></strong>ï¼Œå¯çœç•¥åå­—) å¯return (v0,v1,â€¦,vn)</p>
<p>fallback(åŒ¿åå‡½æ•°)</p>
<h5 id="å‡½æ•°ä¿®é¥°ç¬¦"><a href="#å‡½æ•°ä¿®é¥°ç¬¦" class="headerlink" title="å‡½æ•°ä¿®é¥°ç¬¦"></a>å‡½æ•°ä¿®é¥°ç¬¦</h5><p>ğŸ’¡ åˆ‡è®°åŒºåˆ†å¯è§æ€§(å¯è°ƒç”¨çš„ä½ç½®)å’Œèƒ½ä¸èƒ½çœ‹è§å‡½æ•°å†…å®¹æ˜¯ä¸åŒçš„</p>
<p>è°ƒç”¨å…¶ä»–åˆçº¦(é™¤ç»§æ‰¿å¤–)éœ€è¦å…ˆè·å¾—ä¸€ä¸ªå…¶ä»–åˆçº¦å®ä¾‹c,ç„¶åc.functionxx()</p>
<blockquote>
<p>ğŸ’¡</p>
<ul>
<li>å‡½æ•°å£°æ˜æ—¶é»˜è®¤ä¸º<strong><code>public</code></strong>ç±»å‹ï¼Œå’Œæ˜¾ç¤ºå£°æ˜ä¸º<strong><code>public</code></strong>ç±»å‹çš„å‡½æ•°ä¸€æ ·ï¼Œéƒ½å¯ä¾›å¤–éƒ¨è®¿é—®ã€‚</li>
<li>æ„é€ å‡½æ•°å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½å£°æ˜ä¸º<code>public</code>ç±»å‹ã€‚</li>
<li>æ‰€æœ‰åœ¨åˆçº¦å†…çš„ä¸œè¥¿å¯¹å¤–éƒ¨çš„è§‚å¯Ÿè€…æ¥è¯´éƒ½æ˜¯å¯è§çš„ï¼Œå°†æŸäº›ä¸œè¥¿æ ‡è®°ä¸º<strong><code>private</code></strong>ä»…ä»…é˜»æ­¢äº†å…¶å®ƒåˆçº¦æ¥è¿›è¡Œè®¿é—®(è°ƒç”¨)å’Œä¿®æ”¹ï¼Œä½†å¹¶ä¸èƒ½é˜»æ­¢å…¶å®ƒäººçœ‹åˆ°ç›¸å…³çš„ä¿¡æ¯[å¯ä»¥çœ‹åˆ°å‡½æ•°æ˜¯å¹²å•¥çš„ï¼Œå‡½æ•°ä½“é‡Œå¤´æœ‰å•¥å†…å®¹ï¼Œä½†æ˜¯æ²¡æ³•è°ƒç”¨ï¼Œæ²¡æ³•æ”¹]ã€‚</li>
<li>å¯è§æ€§çš„æ ‡è¯†ç¬¦çš„å®šä¹‰ä½ç½®ï¼Œ==å¯¹äºå˜é‡å£°æ˜æ¥è¯´æ˜¯åœ¨ç±»å‹çš„åé¢==ï¼Œ==å¯¹äºå‡½æ•°å£°æ˜æ¥è¯´æ˜¯åœ¨å‚æ•°åˆ—è¡¨å’Œè¿”å›å…³é”®å­—(returns)ä¸­é—´==ã€‚</li>
<li>çŠ¶æ€å˜é‡å£°æ˜æ—¶ï¼Œé»˜è®¤ä¸º<strong><code>internal</code></strong>ç±»å‹ï¼Œåªæœ‰æ˜¾ç¤ºå£°æ˜ä¸º<strong><code>public</code></strong>ç±»å‹çš„çŠ¶æ€å˜é‡æ‰ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå’ŒçŠ¶æ€å˜é‡åŒåçš„<strong><code>get</code></strong>å‡½æ•°ä»¥ä¾›å¤–éƒ¨è·å–å½“å‰çŠ¶æ€å˜é‡çš„å€¼ã€‚çŠ¶æ€å˜é‡æ— æ³•å£°æ˜ä¸º<code>external</code>ç±»å‹ã€‚</li>
</ul>
</blockquote>
<h6 id="å¯è§æ€§-ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼"><a href="#å¯è§æ€§-ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼" class="headerlink" title="å¯è§æ€§ ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼"></a>å¯è§æ€§ ä¸åˆ»æ„å£°æ˜æ—¶æœ‰é»˜è®¤å€¼</h6><p>å‡½æ•°å¯è§æ€§é»˜è®¤ä¸ºpublic</p>
<p>çŠ¶æ€å˜é‡å¯è§æ€§é»˜è®¤ä¸ºinternal æ— æ³•å£°æ˜ä¸ºexternal</p>
<p>ç»“æ„ä½“é»˜è®¤ä¸ºinternal ä¸”æ— æ³•åŠ ä»»ä½•å…¶ä»–çš„å¯è§æ€§å£°æ˜</p>
<table>
<thead>
<tr>
<th>ä¿®é¥°ç¬¦</th>
<th>æ„ä¹‰</th>
<th style="text-align:center">åˆ†ç±»</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>ä»»ä½•äºº(åŒ…æ‹¬å„¿å­)å¯ä»¥è°ƒç”¨(åŒä¸€ä¸ªsolæ–‡ä»¶å†…éƒ¨å¯ä»¥ç›´æ¥è°ƒç”¨,å…¶ä»–æ–‡ä»¶éœ€è¦importå¼•å…¥)è¯¥å‡½æ•°ï¼Œå’Œprivateäº’æ–¥</td>
<td style="text-align:center">è°ƒç”¨æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>private</td>
<td>åªæœ‰è¯¥åˆçº¦èƒ½è°ƒç”¨(å„¿å­éƒ½ä¸å¯)ï¼Œå’Œpublicäº’æ–¥</td>
<td style="text-align:center">è°ƒç”¨æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>external</td>
<td>å¤–éƒ¨å‡½æ•°ã€‚å†…éƒ¨ä¸å¯è®¿é—®(å¯this)ï¼Œå¤–éƒ¨æ­£å¸¸è®¿é—®ï¼Œå­ç±»å¯ç»§æ‰¿ã€‚</td>
<td style="text-align:center">è°ƒç”¨æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>internal</td>
<td>å†…éƒ¨å‡½æ•°ã€‚å†…éƒ¨æ­£å¸¸è®¿é—®ï¼Œå¤–éƒ¨æ— æ³•è®¿é—®ï¼Œå­ç±»å¯ç»§æ‰¿ã€‚</td>
<td style="text-align:center">è°ƒç”¨æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>view</td>
<td>åˆçº¦ä¸ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œå’Œconstantä¸€æ ·</td>
<td style="text-align:center">çŠ¶æ€å˜é‡è®¿é—®æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>constant</td>
<td>åˆçº¦ä¸ä¿®æ”¹çŠ¶æ€å˜é‡ï¼Œå’Œconstantä¸€æ ·</td>
<td style="text-align:center">çŠ¶æ€å˜é‡è®¿é—®æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>pure</td>
<td>åˆçº¦ä¸ä½†ä¸ä¿®æ”¹ï¼Œä¹Ÿä¸è¯»å–çŠ¶æ€å˜é‡</td>
<td style="text-align:center">çŠ¶æ€å˜é‡è®¿é—®æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>payable</td>
<td>æ¶‰åŠeth(å…¶ä»–tokenä¸ç®—)çš„è½¬ç§»æ“ä½œéœ€è¦åŠ ä¸Šè¿™ä¸ª</td>
<td style="text-align:center">èµ„é‡‘æ§åˆ¶ç±»</td>
</tr>
<tr>
<td>è‡ªå®šä¹‰ä¿®é¥°ç¬¦</td>
<td>è‡ªå®šä¹‰ä¿®é¥°ç¬¦å·modifier</td>
<td style="text-align:center">è‡ªå®šä¹‰æ§åˆ¶ç±»</td>
</tr>
</tbody>
</table>
<p>å‡½æ•°ä¸­æœ‰transferã€sendç­‰æ–¹æ³•ï¼Œåˆ™éœ€è¦åŠ ä¸Špayableä¿®é¥°</p>
<p>åˆçº¦ä¸­çš„structæ•°ç»„çš„å¯è§æ€§åªæ”¯æŒinternal(é»˜è®¤å€¼ï¼Œä¸éœ€è¦å†™)ï¼Œä¸èƒ½å£°æ˜å…¶ä»–å¯è§æ€§ï¼ï¼(æ–°ç‰ˆæœ¬ä¹Ÿçœ‹ä¸‹)</p>
<p>==externalè°ƒç”¨æ³¨æ„==</p>
<p>åˆçº¦å†…æˆ–åä»£åˆçº¦(ç»§æ‰¿)éœ€è¦ç”¨thisæ–¹å¼è°ƒç”¨ï¼Œæ­¤å¤–åˆçº¦å¤–éƒ¨ç›´æ¥ç”¨åˆçº¦å®ä¾‹è°ƒå³å¯ã€‚b.externalFn();</p>
<p>==å‡½æ•°è¿”å›å€¼returnç”¨æ³•==</p>
<ol>
<li><p>function .. returns (type _result){â€¦;_result = xxx;}</p>
<p>å®šä¹‰å‡ºå‚æ—¶åŠ ä¸Šå˜é‡åï¼Œå‡½æ•°ä½“ä¸å†™return</p>
</li>
<li><p>function .. returns (type){â€¦;return result;}</p>
<p>å®šä¹‰å‡ºå‚æ—¶ä¸åŠ å˜é‡åï¼Œå‡½æ•°ä½“å†™return</p>
</li>
</ol>
<p>å‡½æ•°è‹¥å£°æ˜æˆprivateç§æœ‰çš„ï¼Œremixå³ä¾§å·¥å…·æ æ˜¯æ— æ³•çœ‹åˆ°å’Œè°ƒç”¨çš„ï¼›å£°æ˜æˆexternalå’Œpublicæ‰å¯ä»¥ã€‚</p>
<p>viewå’Œconstantåœ¨remixä¸­ä¸ºè“è‰²çš„ï¼Œpureå¯ç”¨äºè®¡ç®—(åªæ˜¯ä¼ å‚ï¼Œä¸å…³å¿ƒåˆ«çš„)</p>
<p>publicå˜é‡ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒåæŸ¥è¯¢å‡½æ•°ï¼Œè“è‰²ã€‚</p>
<p>æŸ¥è¯¢æœ€å¥½å¸¦ä¸Šviewï¼Œå› ä¸ºä¸æ¶ˆè€—gaså•Šï¼Œç»™åŠ›</p>
<p>å‡½æ•°å¤šä¸ªè¿”å›å€¼ï¼Œåªæƒ³å–åé¢çš„è¿”å›å€¼çš„æ–¹æ³•ï¼š</p>
<blockquote>
<p>(,,,,,result) = functionA();</p>
</blockquote>
<p>==returnåœ¨å“ªçœ‹==</p>
<ol>
<li>åœ¨æ§åˆ¶å°debugçš„decoded outputå­—æ®µçœ‹</li>
<li>åœ¨å³ä¾§å·¥å…·çª—å£debuggeré¡µç­¾çš„Solidity Stateçœ‹æ‰€æœ‰çŠ¶æ€ï¼Œè¿™å„¿å¯ä»¥çœ‹åˆ°</li>
<li>å¦‚æœå¸¦ä¸Šviewä¿®é¥°ç¬¦ï¼Œç›´æ¥åœ¨å³ä¾§ç•Œé¢å¯ä»¥çœ‹ï¼Œè°ƒç”¨æ–¹æ³•åå°±åœ¨å‡½æ•°åä¸‹å¯ä»¥çœ‹åˆ°</li>
</ol>
<p>==ï¼æ³¨æ„æ³¨æ„ï¼==</p>
<p>viewå’Œpureçš„å‡½æ•° è¢«åˆçº¦å¤–éƒ¨(å³å¤–éƒ¨è´¦æˆ·)è°ƒç”¨æ—¶ä¸èŠ±è´¹gas</p>
<p>ä½†å®ƒä»¬è¢«å†…éƒ¨å…¶ä»–å‡½æ•°è°ƒç”¨æ—¶ ä¼šè€—è´¹gas (å–å†³äºä¸»è°ƒå‡½æ•°)</p>
<h5 id="require-assert-revert"><a href="#require-assert-revert" class="headerlink" title="require assert revert"></a>require assert revert</h5><p>if(msg.sender==owner){</p>
<p>//dosomething</p>
<p>}else{</p>
<p>â€‹    revert();</p>
<p>}</p>
<p>ä¸æ»¡è¶³æ¡ä»¶ä¼šrevertå›æ»š</p>
<p>æ›´å¥½çš„å†™æ³•</p>
<p>require(msg.sender\==owner)//æˆ–assert(msg.sender==owner)</p>
<p>//dosomething</p>
<p>æ•ˆæœä¸€æ ·ï¼Œä½†æ›´ç®€æ´æ›´è¯­ä¹‰åŒ–</p>
<h5 id="äº‹ä»¶"><a href="#äº‹ä»¶" class="headerlink" title="äº‹ä»¶"></a>äº‹ä»¶</h5><p>å¯ç”¨äºæ‰“æ—¥å¿—</p>
<p>åœ¨logsé¡¹ä¸­çš„eventå­—æ®µå¯ä»¥çœ‹åˆ°äº‹ä»¶ä¸­å®šä¹‰äº†çš„å‚æ•°</p>
<p>å£°æ˜ï¼š</p>
<p>Event BidEvent(address _myAddr,uint _myMoney)</p>
<p>ä½¿ç”¨ï¼š</p>
<p>åœ¨å‡½æ•°ä¸­å‘å°„ emit BidEvent(myAddr,myMoney); </p>
<h5 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h5><p>pushæ–¹æ³•åªèƒ½å¯¹å˜é•¿æ•°ç»„ä½¿ç”¨</p>
<p>å¦‚æœæƒ³ç”¨deleteåˆ æ•°ç»„å…ƒç´ ï¼Œä¹Ÿç”¨å˜é•¿æ•°ç»„å§</p>
<h5 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h5><p>abi.encodePacked(a,b) è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²</p>
<h5 id="web3-js"><a href="#web3-js" class="headerlink" title="web3.js"></a>web3.js</h5><p>RPCæ–¹å¼è®¿é—®ä»¥å¤ªåŠç½‘ç»œ</p>
<blockquote>
<p>èµ„æ–™ï¼š<br><a href="http://cw.hubwiz.com/card/c/web3.js-1.0/1/4/7/" target="_blank" rel="noopener">http://cw.hubwiz.com/card/c/web3.js-1.0/1/4/7/</a></p>
</blockquote>
<p>viewè“è‰²çš„ ç”¨callæ¥è°ƒç”¨ï¼Ÿ</p>
<p>çº¢è‰²çš„ä¸å¸¦viewçš„ ç”¨sendæ¥è°ƒç”¨ï¼Ÿ</p>
<p>==è°ƒç”¨å…³é”®ç‚¹==</p>
<p>è¿æ¥åˆ°ä»¥å¤ªåŠ</p>
<p>å·²çŸ¥åˆçº¦ABI</p>
<p>å·²çŸ¥åˆçº¦åœ°å€(é€šè¿‡ABIä¹Ÿå¯ä»¥éƒ¨ç½²æ–°åˆçº¦) çŸ¥é“ABIå’Œåˆçº¦åœ°å€å¯ä»¥è·å¾—åˆçº¦å®ä¾‹</p>
<p>ä»¥å¤ªåŠå®¢æˆ·ç«¯æ”¯æŒrpc</p>
<ol>
<li><p>åˆ›å»ºåˆçº¦å¯¹è±¡</p>
</li>
<li><p>é€šè¿‡åˆçº¦åœ°å€å’Œåˆçº¦abiè·å¾—åˆçº¦å®ä¾‹</p>
</li>
<li><p>è°ƒç”¨åˆçº¦ä¸­çš„æ–¹æ³•</p>
<p>å®ä¾‹.methods.functionName().call()</p>
</li>
</ol>
<p>æˆ–è€…methods.functionName().send()</p>
<p>callå¯ä»¥ä¸ç”¨fromå’Œgasï¼Œsendå¿…é¡»æœ‰fromå’Œgas</p>
<p>call(function(){})</p>
<p>send({},function(){})</p>
<h6 id="At-Address-åŠ è½½å·²éƒ¨ç½²åˆçº¦"><a href="#At-Address-åŠ è½½å·²éƒ¨ç½²åˆçº¦" class="headerlink" title="At Address åŠ è½½å·²éƒ¨ç½²åˆçº¦"></a>At Address åŠ è½½å·²éƒ¨ç½²åˆçº¦</h6><p>ä¹‹å‰éƒ¨ç½²è¿‡çš„åˆçº¦ï¼Œæœ‰æ•°æ®ï¼Œ</p>
<h5 id="importå¼•å…¥çš„ç”¨æ³•"><a href="#importå¼•å…¥çš„ç”¨æ³•" class="headerlink" title="importå¼•å…¥çš„ç”¨æ³•"></a>importå¼•å…¥çš„ç”¨æ³•</h5><ul>
<li>import â€œ./xxx.solâ€</li>
<li></li>
</ul>
<h5 id="åº“libraryçš„ç”¨æ³•"><a href="#åº“libraryçš„ç”¨æ³•" class="headerlink" title="åº“libraryçš„ç”¨æ³•"></a>åº“libraryçš„ç”¨æ³•</h5><ol>
<li><p>import {Console} from â€œ./Console.solâ€; //Consoleä¸ºlibraryåå­—</p>
<p>ä½¿ç”¨æ—¶Console.log(xxx) è°ƒç”¨åº“å.æ–¹æ³•</p>
</li>
<li><p>import â€œ./AddressUtils.solâ€;</p>
<p>åˆçº¦å†… using AddressUtils for address; ç„¶åaddressç±»å‹è‡ªå¸¦æ–¹æ³•isContract</p>
<p>ä½¿ç”¨æ—¶isContract(addrxxx) æˆ–è€… addrxx.isContract()?</p>
</li>
</ol>
<h5 id="solidity-0-5-0é‚£äº›äº‹"><a href="#solidity-0-5-0é‚£äº›äº‹" class="headerlink" title="solidity 0.5.0é‚£äº›äº‹"></a>solidity 0.5.0é‚£äº›äº‹</h5><p><a href="https://www.colabug.com/4931922.html" target="_blank" rel="noopener">https://www.colabug.com/4931922.html</a></p>
<ul>
<li>åœ°å€åˆ†ä¸ºaddresså’Œaddress payable,å¿…é¡»æ˜¾å¼å£°æ˜äº†payableæ‰å¯ä»¥transfer send</li>
<li>external çš„å‡½æ•°å‚æ•°(æ™®é€šç±»å‹æ•°ç»„!ç±»å‹)éœ€æ˜¾å¼å£°æ˜ä¸º calldata,å…¶ä»–æŒ‰å„è‡ªè§„åˆ™æ¥ã€‚</li>
<li>keccak256(abi.encodePacked(a,b,c)) å¿…é¡»åŠ ä¸Šabi.encodePacked</li>
<li>bytes32æ— æ³•è½¬ä¸ºuint8,ä½†æ˜¯å¯ä»¥è½¬ä¸ºuint(å³uint256)</li>
<li>uintå’Œuint8 ä¸€èµ·è¿ç®—å¯èƒ½ä¼šè¢«ç¦æ­¢</li>
<li>selfdestructå‚æ•°çš„åœ°å€aå¿…é¡»ä¸ºaddress payable,å› ä¸ºè¦æŠŠé’±æ‰“åˆ°aé‚£å„¿,payableæ‰å¯ä»¥æ¥æ”¶é’±ã€‚</li>
<li>æœ€æ–°ç‰ˆæœ¬ï¼stringç±»å‹çš„å‡½æ•°å‚æ•°éœ€è¦æ˜¾ç¤ºå¢åŠ memoryå£°æ˜</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">superman285</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://skr.dog/2019/01/26/Solidityå­¦ä¹ ç¬”è®°/">https://skr.dog/2019/01/26/Solidityå­¦ä¹ ç¬”è®°/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Ethereum/">Ethereum</a><a class="post-meta__tags" href="/tags/Solidity/">Solidity</a><a class="post-meta__tags" href="/tags/BlockChain/">BlockChain</a><a class="post-meta__tags" href="/tags/æ™ºèƒ½åˆçº¦/">æ™ºèƒ½åˆçº¦</a></div><div class="social-share" data-disabled="douban,heart,tencent,qzone,linkedin,diandian"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/02/22/å·¥å…·ç±»åˆçº¦æˆ–åº“çš„ä½¿ç”¨/"><i class="fa fa-chevron-left">  </i><span>å·¥å…·ç±»åˆçº¦æˆ–åº“çš„ä½¿ç”¨</span></a></div><div class="next-post pull-right"><a href="/2019/01/22/npmå¸¸ç”¨çŸ¥è¯†ç‚¹/"><span>npmå¸¸ç”¨çŸ¥è¯†ç‚¹</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="gitalk-container"></div><script>var gitalk = new Gitalk({
  clientID: 'ab689454493850e68d9d',
  clientSecret: '0f6ef510c8c9083679f478cadd47fed8361f3a51',
  repo: 'superman285.github.io',
  owner: 'superman285',
  admin: 'superman285',
  id: md5(decodeURI(location.pathname)),
  language: ''
})
gitalk.render('gitalk-container')</script></div></div><footer class="footer-bg" style="background-image: url(https://i.loli.net/2019/02/22/5c6f8ab4867b6.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2018 - 2019 By superman285</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="icp"><a href="http://www.miitbeian.gov.cn"><span>ç²¤ICPå¤‡19022229å·</span></a><br><img src="/img/beian.png"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11010502037612"><span>äº¬å…¬ç½‘å®‰å¤‡11010502037612å·</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script src="/js/search/local-search.js"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="please input what you want"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>